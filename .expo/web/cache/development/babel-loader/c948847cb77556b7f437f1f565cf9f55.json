{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { auth } from \"../firebase\";\nimport { db } from \"../firebase\";\nimport { collection, onSnapshot, query, where, addDoc, getDocs } from 'firebase/firestore';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Message(_ref) {\n  var route = _ref.route;\n  var conversationId = route.params.conversationId;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      conversation = _useState2[0],\n      setConversation = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      message = _useState4[0],\n      setMessage = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      displayName = _useState6[0],\n      setDisplayName = _useState6[1];\n\n  useEffect(function () {\n    return onSnapshot(query(collection(db, 'Messages'), where('conversationId', '==', conversationId)), function (snapshot) {\n      return setConversation(snapshot.docs.map(function (convo) {\n        console.log('Grabbing Messages');\n        return convo.data();\n      }).sort(function (a, b) {\n        return a.timestamp - b.timestamp;\n      }));\n    });\n  }, []);\n\n  if (!displayName) {\n    var _auth$currentUser;\n\n    getDocs(query(collection(db, 'users'), where('uid', '==', (_auth$currentUser = auth.currentUser) == null ? void 0 : _auth$currentUser.uid))).then(function (user) {\n      console.log('Grabbing Username'), setDisplayName(user.docs[0].data().name);\n    });\n  }\n\n  var handleSend = function handleSend() {\n    addDoc(collection(db, 'Messages'), {\n      conversationId: conversationId,\n      timestamp: Date.now(),\n      content: displayName + ': ' + message\n    }).then(function () {\n      setMessage('');\n    }).catch(function (error) {\n      return alert(error.message);\n    });\n  };\n\n  return _jsxs(KeyboardAvoidingView, {\n    style: {\n      flex: 1,\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    children: [_jsx(View, {\n      style: styles.messageContainer,\n      children: conversation.map(function (convo, index) {\n        return _jsx(Text, {\n          style: styles.message,\n          children: convo.content\n        }, index);\n      })\n    }), _jsx(View, {\n      style: styles.inputContainer,\n      children: _jsx(TextInput, {\n        placeholder: \"Message\",\n        value: message,\n        onChangeText: function onChangeText(text) {\n          return setMessage(text);\n        },\n        style: styles.input\n      })\n    }), _jsx(View, {\n      style: styles.buttonContainer,\n      children: _jsx(TouchableOpacity, {\n        onPress: handleSend,\n        style: styles.button,\n        children: _jsx(Text, {\n          style: styles.buttonText,\n          children: \"Send\"\n        })\n      })\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  messageContainer: {\n    alignSelf: 'flex-start',\n    alignItems: 'left',\n    paddingHorizontal: '10%'\n  },\n  message: {\n    backgroundColor: 'white',\n    paddingVertical: 5,\n    paddingHorizontal: 5,\n    marginTop: 5,\n    borderRadius: 10\n  },\n  inputContainer: {\n    width: '80%'\n  },\n  input: {\n    backgroundColor: 'white',\n    paddingHorizontal: 15,\n    paddingVertical: 10,\n    borderRadius: 10,\n    marginTop: 5\n  },\n  buttonContainer: {\n    width: '60%',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 40\n  },\n  button: {\n    backgroundColor: '#0782F9',\n    width: '100%',\n    padding: 15,\n    borderRadius: 10,\n    alignItems: 'center'\n  },\n  buttonOutline: {\n    backgroundColor: 'white',\n    marginTop: 5,\n    borderColor: '#0782F9',\n    borderWidth: 2\n  },\n  buttonText: {\n    color: 'white',\n    fontWeight: '700',\n    fontSize: 16\n  },\n  buttonOutlineText: {\n    color: '#0782F9',\n    fontWeight: '700',\n    fontSize: 16\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","auth","db","collection","onSnapshot","query","where","addDoc","getDocs","Message","route","conversationId","params","conversation","setConversation","message","setMessage","displayName","setDisplayName","snapshot","docs","map","convo","console","log","data","sort","a","b","timestamp","currentUser","uid","then","user","name","handleSend","Date","now","content","catch","error","alert","flex","alignItems","justifyContent","styles","messageContainer","index","inputContainer","text","input","buttonContainer","button","buttonText","StyleSheet","create","container","alignSelf","paddingHorizontal","backgroundColor","paddingVertical","marginTop","borderRadius","width","padding","buttonOutline","borderColor","borderWidth","color","fontWeight","fontSize","buttonOutlineText"],"sources":["C:/Users/16476/Documents/GitHub/Haven/screens/Message.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Text, View, KeyboardAvoidingView, TextInput, TouchableOpacity, } from \"react-native\";\r\nimport { auth } from '../firebase'\r\nimport { db } from '../firebase'\r\nimport { collection, onSnapshot, query, where, addDoc, getDocs } from 'firebase/firestore' \r\n\r\nexport default function Message({ route }) {\r\n    const { conversationId } = route.params\r\n    const [conversation, setConversation] = useState([])\r\n    const [message, setMessage] = useState('')\r\n    const [displayName, setDisplayName] = useState('')\r\n\r\n    useEffect(\r\n        () => \r\n            onSnapshot(query(collection(db, 'Messages'), where('conversationId', '==', conversationId)), (snapshot) =>\r\n            setConversation(snapshot.docs.map(convo => {\r\n              console.log('Grabbing Messages')\r\n                return convo.data()\r\n            }).sort((a,b) => a.timestamp - b.timestamp))\r\n            )\r\n    ,[])\r\n\r\n    if (!displayName){\r\n      getDocs(query(collection(db, 'users'), where('uid', '==', auth.currentUser?.uid)))\r\n      .then(user => {\r\n        console.log('Grabbing Username'),\r\n        setDisplayName(user.docs[0].data().name)\r\n      })\r\n    }\r\n           \r\n          \r\n\r\n    const handleSend = () => {\r\n        addDoc(collection(db, 'Messages'),{conversationId, timestamp: Date.now(), content: displayName + ': ' + message})\r\n        .then(() => {\r\n          setMessage('')\r\n        })\r\n        .catch(error => alert(error.message))\r\n    }\r\n    \r\n    return (\r\n        <KeyboardAvoidingView style={{ flex: 1, alignItems: 'center', justifyContent: 'center'}}>\r\n            <View style={styles.messageContainer}>\r\n              {conversation.map((convo,index) => <Text key={index} style={styles.message}>{convo.content}</Text>)}\r\n            </View>\r\n            <View style={styles.inputContainer}>\r\n                <TextInput \r\n                placeholder='Message'\r\n                value={message}\r\n                 onChangeText={text => setMessage(text)}\r\n                style={styles.input}\r\n                />\r\n            </View>\r\n            <View style={styles.buttonContainer}>\r\n                <TouchableOpacity\r\n                    onPress={handleSend}\r\n                    style={styles.button}\r\n                >\r\n                    <Text style={styles.buttonText}>Send</Text>\r\n                </TouchableOpacity>\r\n            </View>\r\n        </KeyboardAvoidingView>\r\n    )\r\n}\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n      flex: 1,\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n    },\r\n    messageContainer: {\r\n      alignSelf: 'flex-start',\r\n      alignItems: 'left',\r\n      paddingHorizontal: '10%'\r\n    },\r\n    message: {\r\n      backgroundColor: 'white',\r\n      paddingVertical: 5,\r\n      paddingHorizontal: 5,\r\n      marginTop: 5,\r\n      borderRadius: 10\r\n    },\r\n    inputContainer: {\r\n      width: '80%'\r\n    },\r\n    input: {\r\n      backgroundColor: 'white',\r\n      paddingHorizontal: 15,\r\n      paddingVertical: 10,\r\n      borderRadius: 10,\r\n      marginTop: 5,\r\n    },\r\n    buttonContainer: {\r\n      width: '60%',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      marginTop: 40,\r\n    },\r\n    button: {\r\n      backgroundColor: '#0782F9',\r\n      width: '100%',\r\n      padding: 15,\r\n      borderRadius: 10,\r\n      alignItems: 'center',\r\n    },\r\n    buttonOutline: {\r\n      backgroundColor: 'white',\r\n      marginTop: 5,\r\n      borderColor: '#0782F9',\r\n      borderWidth: 2,\r\n    },\r\n    buttonText: {\r\n      color: 'white',\r\n      fontWeight: '700',\r\n      fontSize: 16,\r\n    },\r\n    buttonOutlineText: {\r\n      color: '#0782F9',\r\n      fontWeight: '700',\r\n      fontSize: 16,\r\n    },\r\n  })"],"mappings":"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"},"metadata":{},"sourceType":"module"}