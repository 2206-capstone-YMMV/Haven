{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { auth } from \"../firebase\";\nimport { db } from \"../firebase\";\nimport { collection, onSnapshot, query, where, addDoc, getDocs } from \"firebase/firestore\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Message(_ref) {\n  var route = _ref.route;\n  console.log(\"messages\", route);\n  var conversationId = route.params.conversationId;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      conversation = _useState2[0],\n      setConversation = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      message = _useState4[0],\n      setMessage = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      displayName = _useState6[0],\n      setDisplayName = _useState6[1];\n\n  useEffect(function () {\n    return onSnapshot(query(collection(db, \"Messages\"), where(\"conversationId\", \"==\", conversationId)), function (snapshot) {\n      return setConversation(snapshot.docs.map(function (convo) {\n        console.log(\"Grabbing Messages\");\n        return convo.data();\n      }).sort(function (a, b) {\n        return a.timestamp - b.timestamp;\n      }));\n    });\n  }, []);\n\n  if (!displayName) {\n    var _auth$currentUser;\n\n    getDocs(query(collection(db, \"users\"), where(\"uid\", \"==\", (_auth$currentUser = auth.currentUser) == null ? void 0 : _auth$currentUser.uid))).then(function (user) {\n      console.log(\"Grabbing Username\"), setDisplayName(user.docs[0].data().name);\n    });\n  }\n\n  var handleSend = function handleSend() {\n    addDoc(collection(db, \"Messages\"), {\n      conversationId: conversationId,\n      timestamp: Date.now(),\n      content: displayName + \": \" + message\n    }).then(function () {\n      setMessage(\"\");\n    }).catch(function (error) {\n      return alert(error.message);\n    });\n  };\n\n  return _jsxs(KeyboardAvoidingView, {\n    style: {\n      flex: 1,\n      alignItems: \"center\",\n      justifyContent: \"center\"\n    },\n    children: [_jsx(View, {\n      style: styles.messageContainer,\n      children: conversation.map(function (convo, index) {\n        return _jsx(Text, {\n          style: styles.message,\n          children: convo.content\n        }, index);\n      })\n    }), _jsx(View, {\n      style: styles.inputContainer,\n      children: _jsx(TextInput, {\n        placeholder: \"Message\",\n        value: message,\n        onChangeText: function onChangeText(text) {\n          return setMessage(text);\n        },\n        style: styles.input\n      })\n    }), _jsx(View, {\n      style: styles.buttonContainer,\n      children: _jsx(TouchableOpacity, {\n        onPress: handleSend,\n        style: styles.button,\n        children: _jsx(Text, {\n          style: styles.buttonText,\n          children: \"Send\"\n        })\n      })\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  messageContainer: {\n    alignSelf: \"flex-start\",\n    alignItems: \"left\",\n    paddingHorizontal: \"10%\"\n  },\n  message: {\n    backgroundColor: \"white\",\n    paddingVertical: 5,\n    paddingHorizontal: 5,\n    marginTop: 5,\n    borderRadius: 10\n  },\n  inputContainer: {\n    width: \"80%\"\n  },\n  input: {\n    backgroundColor: \"white\",\n    paddingHorizontal: 15,\n    paddingVertical: 10,\n    borderRadius: 10,\n    marginTop: 5\n  },\n  buttonContainer: {\n    width: \"60%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginTop: 40\n  },\n  button: {\n    backgroundColor: \"#0782F9\",\n    width: \"100%\",\n    padding: 15,\n    borderRadius: 10,\n    alignItems: \"center\"\n  },\n  buttonOutline: {\n    backgroundColor: \"white\",\n    marginTop: 5,\n    borderColor: \"#0782F9\",\n    borderWidth: 2\n  },\n  buttonText: {\n    color: \"white\",\n    fontWeight: \"700\",\n    fontSize: 16\n  },\n  buttonOutlineText: {\n    color: \"#0782F9\",\n    fontWeight: \"700\",\n    fontSize: 16\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","auth","db","collection","onSnapshot","query","where","addDoc","getDocs","Message","route","console","log","conversationId","params","conversation","setConversation","message","setMessage","displayName","setDisplayName","snapshot","docs","map","convo","data","sort","a","b","timestamp","currentUser","uid","then","user","name","handleSend","Date","now","content","catch","error","alert","flex","alignItems","justifyContent","styles","messageContainer","index","inputContainer","text","input","buttonContainer","button","buttonText","StyleSheet","create","container","alignSelf","paddingHorizontal","backgroundColor","paddingVertical","marginTop","borderRadius","width","padding","buttonOutline","borderColor","borderWidth","color","fontWeight","fontSize","buttonOutlineText"],"sources":["C:/Users/16476/Documents/GitHub/Haven/screens/Message.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  StyleSheet,\r\n  Text,\r\n  View,\r\n  KeyboardAvoidingView,\r\n  TextInput,\r\n  TouchableOpacity,\r\n} from \"react-native\";\r\nimport { auth } from \"../firebase\";\r\nimport { db } from \"../firebase\";\r\nimport {\r\n  collection,\r\n  onSnapshot,\r\n  query,\r\n  where,\r\n  addDoc,\r\n  getDocs,\r\n} from \"firebase/firestore\";\r\n\r\nexport default function Message({ route }) {\r\n  console.log(\"messages\", route);\r\n  const { conversationId } = route.params;\r\n  const [conversation, setConversation] = useState([]);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [displayName, setDisplayName] = useState(\"\");\r\n\r\n  useEffect(\r\n    () =>\r\n      onSnapshot(\r\n        query(\r\n          collection(db, \"Messages\"),\r\n          where(\"conversationId\", \"==\", conversationId)\r\n        ),\r\n        (snapshot) =>\r\n          setConversation(\r\n            snapshot.docs\r\n              .map((convo) => {\r\n                console.log(\"Grabbing Messages\");\r\n                return convo.data();\r\n              })\r\n              .sort((a, b) => a.timestamp - b.timestamp)\r\n          )\r\n      ),\r\n    []\r\n  );\r\n\r\n  if (!displayName) {\r\n    getDocs(\r\n      query(collection(db, \"users\"), where(\"uid\", \"==\", auth.currentUser?.uid))\r\n    ).then((user) => {\r\n      console.log(\"Grabbing Username\"),\r\n        setDisplayName(user.docs[0].data().name);\r\n    });\r\n  }\r\n\r\n  const handleSend = () => {\r\n    addDoc(collection(db, \"Messages\"), {\r\n      conversationId,\r\n      timestamp: Date.now(),\r\n      content: displayName + \": \" + message,\r\n    })\r\n      .then(() => {\r\n        setMessage(\"\");\r\n      })\r\n      .catch((error) => alert(error.message));\r\n  };\r\n\r\n  return (\r\n    <KeyboardAvoidingView\r\n      style={{ flex: 1, alignItems: \"center\", justifyContent: \"center\" }}\r\n    >\r\n      <View style={styles.messageContainer}>\r\n        {conversation.map((convo, index) => (\r\n          <Text key={index} style={styles.message}>\r\n            {convo.content}\r\n          </Text>\r\n        ))}\r\n      </View>\r\n      <View style={styles.inputContainer}>\r\n        <TextInput\r\n          placeholder=\"Message\"\r\n          value={message}\r\n          onChangeText={(text) => setMessage(text)}\r\n          style={styles.input}\r\n        />\r\n      </View>\r\n      <View style={styles.buttonContainer}>\r\n        <TouchableOpacity onPress={handleSend} style={styles.button}>\r\n          <Text style={styles.buttonText}>Send</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    </KeyboardAvoidingView>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n  messageContainer: {\r\n    alignSelf: \"flex-start\",\r\n    alignItems: \"left\",\r\n    paddingHorizontal: \"10%\",\r\n  },\r\n  message: {\r\n    backgroundColor: \"white\",\r\n    paddingVertical: 5,\r\n    paddingHorizontal: 5,\r\n    marginTop: 5,\r\n    borderRadius: 10,\r\n  },\r\n  inputContainer: {\r\n    width: \"80%\",\r\n  },\r\n  input: {\r\n    backgroundColor: \"white\",\r\n    paddingHorizontal: 15,\r\n    paddingVertical: 10,\r\n    borderRadius: 10,\r\n    marginTop: 5,\r\n  },\r\n  buttonContainer: {\r\n    width: \"60%\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    marginTop: 40,\r\n  },\r\n  button: {\r\n    backgroundColor: \"#0782F9\",\r\n    width: \"100%\",\r\n    padding: 15,\r\n    borderRadius: 10,\r\n    alignItems: \"center\",\r\n  },\r\n  buttonOutline: {\r\n    backgroundColor: \"white\",\r\n    marginTop: 5,\r\n    borderColor: \"#0782F9\",\r\n    borderWidth: 2,\r\n  },\r\n  buttonText: {\r\n    color: \"white\",\r\n    fontWeight: \"700\",\r\n    fontSize: 16,\r\n  },\r\n  buttonOutlineText: {\r\n    color: \"#0782F9\",\r\n    fontWeight: \"700\",\r\n    fontSize: 16,\r\n  },\r\n});\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}