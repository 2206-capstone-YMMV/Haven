{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { auth } from \"../firebase\";\nimport { db } from \"../firebase\";\nimport { collection, onSnapshot, query, where, addDoc } from 'firebase/firestore';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Message(_ref) {\n  var route = _ref.route;\n  var ConversationId = route.params.ConversationId;\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      conversation = _useState2[0],\n      setConversation = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      message = _useState4[0],\n      setMessage = _useState4[1];\n\n  useEffect(function () {\n    return onSnapshot(query(collection(db, 'Messages'), where('ConversationId', '==', ConversationId)), function (snapshot) {\n      return setConversation(snapshot.docs.map(function (convo) {\n        return convo.data();\n      }));\n    });\n  }, []);\n\n  var handleSend = function handleSend() {\n    addDoc(collection(db, 'Messages'), {\n      ConversationId: ConversationId,\n      timestamp: Date.now(),\n      content: message\n    }).then(function () {\n      setMessage('');\n    }).catch(function (error) {\n      return alert(error.message);\n    });\n  };\n\n  var convos = [];\n\n  if (Array.isArray(conversation)) {\n    convos = conversation;\n  }\n\n  return _jsxs(KeyboardAvoidingView, {\n    style: {\n      flex: 1,\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    children: [convos.map(function (convo, index) {\n      return _jsx(Text, {\n        children: convo.content\n      }, index);\n    }), _jsx(View, {\n      style: styles.inputContainer,\n      children: _jsx(TextInput, {\n        placeholder: \"Message\",\n        value: message,\n        onChangeText: function onChangeText(text) {\n          return setMessage(text);\n        },\n        style: styles.input\n      })\n    }), _jsx(View, {\n      style: styles.buttonContainer,\n      children: _jsx(TouchableOpacity, {\n        onPress: handleSend,\n        style: styles.button,\n        children: _jsx(Text, {\n          style: styles.buttonText,\n          children: \"Send\"\n        })\n      })\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  inputContainer: {\n    width: '80%'\n  },\n  input: {\n    backgroundColor: 'white',\n    paddingHorizontal: 15,\n    paddingVertical: 10,\n    borderRadius: 10,\n    marginTop: 5\n  },\n  buttonContainer: {\n    width: '60%',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 40\n  },\n  button: {\n    backgroundColor: '#0782F9',\n    width: '100%',\n    padding: 15,\n    borderRadius: 10,\n    alignItems: 'center'\n  },\n  buttonOutline: {\n    backgroundColor: 'white',\n    marginTop: 5,\n    borderColor: '#0782F9',\n    borderWidth: 2\n  },\n  buttonText: {\n    color: 'white',\n    fontWeight: '700',\n    fontSize: 16\n  },\n  buttonOutlineText: {\n    color: '#0782F9',\n    fontWeight: '700',\n    fontSize: 16\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","auth","db","collection","onSnapshot","query","where","addDoc","Message","route","ConversationId","params","conversation","setConversation","message","setMessage","snapshot","docs","map","convo","data","handleSend","timestamp","Date","now","content","then","catch","error","alert","convos","Array","isArray","flex","alignItems","justifyContent","index","styles","inputContainer","text","input","buttonContainer","button","buttonText","StyleSheet","create","container","width","backgroundColor","paddingHorizontal","paddingVertical","borderRadius","marginTop","padding","buttonOutline","borderColor","borderWidth","color","fontWeight","fontSize","buttonOutlineText"],"sources":["C:/Users/16476/Documents/GitHub/Haven/screens/Message.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { StyleSheet, Text, View, KeyboardAvoidingView, TextInput, TouchableOpacity, } from \"react-native\";\r\nimport { auth } from '../firebase'\r\nimport { db } from '../firebase'\r\nimport { collection, onSnapshot, query, where, addDoc } from 'firebase/firestore' \r\n\r\nexport default function Message({ route }) {\r\n    const { ConversationId } = route.params\r\n    const [conversation, setConversation] = useState({})\r\n    const [message, setMessage] = useState('')\r\n\r\n    useEffect(\r\n        () => \r\n            onSnapshot(query(collection(db, 'Messages'), where('ConversationId', '==', ConversationId)), (snapshot) =>\r\n            setConversation(snapshot.docs.map(convo => {\r\n                return convo.data()\r\n            }))\r\n            )\r\n    ,[])\r\n\r\n    const handleSend = () => {\r\n  \r\n        addDoc(collection(db, 'Messages'),{ConversationId, timestamp: Date.now(), content: message})\r\n        .then(() => {\r\n          setMessage('')\r\n        })\r\n        .catch(error => alert(error.message))\r\n    }\r\n\r\n    let convos = []\r\n    if (Array.isArray(conversation)){ //conversation is initially an empty object, would break the map function\r\n        convos = conversation \r\n    }\r\n    return (\r\n        <KeyboardAvoidingView style={{ flex: 1, alignItems: 'center', justifyContent: 'center'}}>\r\n            {convos.map((convo,index) => <Text key={index}>{convo.content}</Text>)}\r\n            <View style={styles.inputContainer}>\r\n                <TextInput \r\n                placeholder='Message'\r\n                value={message}\r\n                 onChangeText={text => setMessage(text)}\r\n                style={styles.input}\r\n                />\r\n            </View>\r\n\r\n            <View style={styles.buttonContainer}>\r\n                <TouchableOpacity\r\n                    onPress={handleSend}\r\n                    style={styles.button}\r\n                >\r\n                    <Text style={styles.buttonText}>Send</Text>\r\n                </TouchableOpacity>\r\n            </View>\r\n        </KeyboardAvoidingView>\r\n    )\r\n}\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n      flex: 1,\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n    },\r\n    inputContainer: {\r\n      width: '80%'\r\n    },\r\n    input: {\r\n      backgroundColor: 'white',\r\n      paddingHorizontal: 15,\r\n      paddingVertical: 10,\r\n      borderRadius: 10,\r\n      marginTop: 5,\r\n    },\r\n    buttonContainer: {\r\n      width: '60%',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      marginTop: 40,\r\n    },\r\n    button: {\r\n      backgroundColor: '#0782F9',\r\n      width: '100%',\r\n      padding: 15,\r\n      borderRadius: 10,\r\n      alignItems: 'center',\r\n    },\r\n    buttonOutline: {\r\n      backgroundColor: 'white',\r\n      marginTop: 5,\r\n      borderColor: '#0782F9',\r\n      borderWidth: 2,\r\n    },\r\n    buttonText: {\r\n      color: 'white',\r\n      fontWeight: '700',\r\n      fontSize: 16,\r\n    },\r\n    buttonOutlineText: {\r\n      color: '#0782F9',\r\n      fontWeight: '700',\r\n      fontSize: 16,\r\n    },\r\n  })"],"mappings":"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"},"metadata":{},"sourceType":"module"}