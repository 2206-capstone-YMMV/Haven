{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { auth, db } from \"../firebase\";\nimport { collection, onSnapshot, addDoc, getDocs, updateDoc, deleteDoc, query, doc, where } from 'firebase/firestore';\nimport MaterialCommunityIcons from \"@expo/vector-icons/MaterialCommunityIcons\";\nimport { useNavigation } from '@react-navigation/core';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar Posts = function Posts() {\n  var colRef = collection(db, 'Post');\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      posts = _useState2[0],\n      setPosts = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      search = _useState4[0],\n      setSearch = _useState4[1];\n\n  var navigation = useNavigation();\n  var filterData = posts.filter(function (post) {\n    return post.description.indexOf(search) >= 0;\n  });\n  useEffect(function () {\n    return onSnapshot(colRef, function (snapshot) {\n      return setPosts(snapshot.docs.map(function (doc) {\n        return _objectSpread(_objectSpread({}, doc.data()), {}, {\n          id: doc.id\n        });\n      }));\n    });\n  }, []);\n\n  var renderFriend = function renderFriend(_ref) {\n    var item = _ref.item;\n    return _jsx(View, {\n      style: {\n        flexDirection: 'row',\n        padding: 20,\n        marginBottom: 20,\n        backgroundColor: 'white',\n        borderRadius: 12,\n        shadowColor: '#000',\n        shadowOffset: {\n          width: 0,\n          height: 10\n        },\n        shadowOpacity: 0.3,\n        shadowRadius: 20\n      },\n      children: _jsxs(View, {\n        children: [_jsx(Text, {\n          style: {\n            fontSize: 22,\n            fontWeight: '700'\n          },\n          children: item.description\n        }), _jsxs(Text, {\n          style: {\n            fontSize: 18,\n            opacity: 0.7\n          },\n          children: [\"posted by: \", item.username]\n        }), _jsxs(Text, {\n          style: {\n            fontSize: 14,\n            opacity: 0.8,\n            color: '#0099cc'\n          },\n          children: [item.contents, \" \"]\n        }), _jsxs(Text, {\n          onPress: function onPress() {\n            return like(item.id, item.likes);\n          },\n          children: [\"Like  \", item.likes]\n        })]\n      })\n    });\n  };\n\n  var like = function like(id, postLikes) {\n    console.log('Updating likes');\n    getDocs(query(collection(db, 'Likes'), where('postId', '==', id), where('uid', '==', auth.currentUser.uid))).then(function (checkLike) {\n      if (checkLike.docs.length < 1) {\n        addDoc(collection(db, 'Likes'), {\n          postId: id,\n          uid: auth.currentUser.uid\n        }).then(updateDoc(doc(db, 'Post', id), {\n          likes: postLikes + 1\n        }));\n      } else {\n        deleteDoc(doc(db, 'Likes', checkLike.docs[0].id)).then(updateDoc(doc(db, 'Post', id), {\n          likes: postLikes - 1\n        }));\n      }\n    });\n  };\n\n  return _jsxs(View, {\n    children: [_jsxs(View, {\n      children: [_jsx(Text, {\n        onPress: function onPress() {\n          return navigation.navigate('NewPost');\n        },\n        style: {\n          fontSize: 26,\n          fontWeight: \"bold\"\n        },\n        children: \"New Posts\"\n      }), _jsx(Text, {\n        onPress: function onPress() {\n          return navigation.navigate('MyPosts');\n        },\n        style: {\n          fontSize: 26,\n          fontWeight: \"bold\"\n        },\n        children: \"My Posts\"\n      })]\n    }), _jsxs(View, {\n      children: [_jsxs(View, {\n        style: styles.searchWrapperStyle,\n        children: [_jsx(TextInput, {\n          style: styles.textInput,\n          value: search,\n          placeholder: \"Search By description\",\n          underlineColorAndroid: \"transparent\",\n          onChangeText: function onChangeText(text) {\n            return setSearch(text);\n          }\n        }), _jsx(MaterialCommunityIcons, {\n          style: styles.iconStyle,\n          name: \"backspace-outline\",\n          size: 23,\n          onPress: function onPress() {\n            setSearch('');\n          }\n        })]\n      }), _jsx(FlatList, {\n        data: filterData,\n        contentContainerStyle: {\n          padding: 15\n        },\n        renderItem: renderFriend\n      })]\n    })]\n  });\n};\n\nexport default Posts;\nvar styles = StyleSheet.create({\n  posts: {\n    marginTop: 10,\n    marginBottom: 30\n  },\n  textInput: {\n    height: 50,\n    borderWidth: 1,\n    paddingLeft: 20,\n    margin: 5,\n    flex: 1,\n    fontSize: 16,\n    paddingVertical: 8,\n    paddingHorizontal: 0,\n    marginBottom: 30,\n    borderColor: '#009688',\n    backgroundColor: 'white'\n  },\n  iconStyle: {\n    marginTop: 12,\n    marginHorizontal: 8\n  },\n  searchWrapperStyle: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\"\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","auth","db","collection","onSnapshot","addDoc","getDocs","updateDoc","deleteDoc","query","doc","where","MaterialCommunityIcons","useNavigation","Posts","colRef","posts","setPosts","search","setSearch","navigation","filterData","filter","post","description","indexOf","snapshot","docs","map","data","id","renderFriend","item","flexDirection","padding","marginBottom","backgroundColor","borderRadius","shadowColor","shadowOffset","width","height","shadowOpacity","shadowRadius","fontSize","fontWeight","opacity","username","color","contents","like","likes","postLikes","console","log","currentUser","uid","then","checkLike","length","postId","navigate","styles","searchWrapperStyle","textInput","text","iconStyle","StyleSheet","create","marginTop","borderWidth","paddingLeft","margin","flex","paddingVertical","paddingHorizontal","borderColor","marginHorizontal","justifyContent"],"sources":["C:/Users/16476/Documents/GitHub/Haven/screens/Posts.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Text, View, FlatList, StyleSheet, TextInput, TouchableOpacity } from \"react-native\";\r\nimport { auth, db } from '../firebase'\r\nimport { collection, onSnapshot, addDoc, getDocs, updateDoc, deleteDoc, query, doc, where } from 'firebase/firestore' \r\nimport MaterialCommunityIcons from 'react-native-vector-icons/MaterialCommunityIcons'\r\nimport { useNavigation } from '@react-navigation/core'\r\nconst  Posts = () => {\r\n    const colRef = collection(db, 'Post')\r\n    const [posts, setPosts] = useState([])\r\n    const [search, setSearch] = useState('')\r\n    const navigation = useNavigation()\r\n\r\n    const filterData = posts.filter((post) => {\r\n        return post.description.indexOf(search) >= 0\r\n    })\r\n\r\n   useEffect(  \r\n    () => \r\n      onSnapshot(colRef, (snapshot) => \r\n      setPosts(snapshot.docs.map((doc) => ({...doc.data(), id: doc.id})))\r\n    )\r\n  ,[])\r\n\r\n  const renderFriend = (({item}) => {\r\n    return (\r\n        <View style={{flexDirection: 'row', padding: 20, marginBottom: 20, backgroundColor:'white', borderRadius: 12,\r\n            shadowColor: '#000', shadowOffset: {width:0, height: 10}, shadowOpacity: 0.3, shadowRadius: 20\r\n            }}>\r\n            <View>\r\n                <Text style={{fontSize: 22, fontWeight: '700'}}>{item.description}</Text>\r\n                <Text style={{fontSize: 18, opacity: 0.7}}>posted by: {item.username}</Text>\r\n                <Text style={{fontSize: 14, opacity: 0.8, color: '#0099cc'}}>{item.contents} </Text>\r\n                <Text onPress={() => like(item.id, item.likes)}>Like  {item.likes}</Text>\r\n            </View>\r\n        </View>\r\n        )\r\n    })\r\n\r\n    const like = (id, postLikes) => {\r\n        console.log('Updating likes')\r\n        getDocs(query(collection(db, 'Likes'), where ('postId', '==', id), where ('uid', '==', auth.currentUser.uid)))\r\n        .then(checkLike => {\r\n            if (checkLike.docs.length < 1){ //If this user hasn't liked this post already\r\n                addDoc(collection(db, 'Likes'), {postId: id, uid: auth.currentUser.uid})\r\n                .then(updateDoc(doc(db, 'Post', id), {likes: postLikes + 1}))\r\n            }\r\n            else{\r\n                deleteDoc(doc(db, 'Likes', checkLike.docs[0].id))\r\n                .then(updateDoc(doc(db, 'Post', id), {likes: postLikes - 1}))\r\n            }\r\n        })\r\n        \r\n    }\r\n\r\n\r\n    return (\r\n        <View>\r\n            <View >\r\n                <Text\r\n                    onPress={() => navigation.navigate('NewPost')}\r\n                    style={{ fontSize: 26, fontWeight: \"bold\" }}>New Posts</Text>\r\n                    <Text\r\n                    onPress={() => navigation.navigate('MyPosts')}\r\n                    style={{ fontSize: 26, fontWeight: \"bold\" }}>My Posts</Text>\r\n            </View>\r\n            <View>\r\n            <View style={styles.searchWrapperStyle}>\r\n                <TextInput \r\n                style={styles.textInput}\r\n                value={search}\r\n                placeholder='Search By description'\r\n                underlineColorAndroid='transparent'\r\n                onChangeText={(text) => setSearch(text)}\r\n                />\r\n                <MaterialCommunityIcons style={styles.iconStyle} name=\"backspace-outline\"  size={23}onPress={() => {\r\n                    setSearch('');\r\n                }} /> \r\n            </View>\r\n            <FlatList \r\n                data={filterData}\r\n                contentContainerStyle={{\r\n                    padding: 15\r\n                }}\r\n                renderItem={renderFriend}\r\n            />\r\n            </View>\r\n        </View>\r\n    )\r\n}\r\n\r\n\r\nexport default Posts\r\n\r\nconst styles = StyleSheet.create({\r\n    posts: {\r\n        marginTop: 10,\r\n        marginBottom: 30\r\n    },\r\n    textInput: {\r\n        height: 50,\r\n        borderWidth: 1,\r\n        paddingLeft: 20,\r\n        margin: 5,\r\n        flex: 1,\r\n        fontSize: 16,\r\n        paddingVertical: 8,\r\n        paddingHorizontal: 0,\r\n        marginBottom: 30,\r\n        borderColor: '#009688',\r\n        backgroundColor: 'white',\r\n\r\n      },\r\n      iconStyle: {\r\n        marginTop: 12,\r\n        marginHorizontal: 8,\r\n      },\r\n      searchWrapperStyle: {\r\n        flexDirection: \"row\",\r\n        justifyContent: \"space-between\",\r\n      },\r\n})"],"mappings":"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"},"metadata":{},"sourceType":"module"}