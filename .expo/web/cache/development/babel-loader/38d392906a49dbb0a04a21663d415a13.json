{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { auth } from \"../firebase\";\nimport { db } from \"../firebase\";\nimport { collection, onSnapshot, query, where, addDoc, getDoc, doc, getDocs } from 'firebase/firestore';\nimport { withTheme } from 'react-native-elements';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Message(_ref) {\n  var route = _ref.route;\n  var ConversationId = route.params.ConversationId;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      conversation = _useState2[0],\n      setConversation = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      message = _useState4[0],\n      setMessage = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      displayName = _useState6[0],\n      setDisplayName = _useState6[1];\n\n  useEffect(function () {\n    return onSnapshot(query(collection(db, 'Messages'), where('ConversationId', '==', ConversationId)), function (snapshot) {\n      return setConversation(snapshot.docs.map(function (convo) {\n        return convo.data();\n      }).sort(function (a, b) {\n        return a.timestamp - b.timestamp;\n      }));\n    });\n  }, []);\n  useEffect(function () {\n    var _auth$currentUser;\n\n    getDocs(query(collection(db, 'users'), where('uid', '==', (_auth$currentUser = auth.currentUser) == null ? void 0 : _auth$currentUser.uid))).then(function (user) {\n      return setDisplayName(user.docs[0].data().name);\n    });\n  });\n\n  var handleSend = function handleSend() {\n    addDoc(collection(db, 'Messages'), {\n      ConversationId: ConversationId,\n      timestamp: Date.now(),\n      content: displayName + ' :' + message\n    }).then(function () {\n      setMessage('');\n    }).catch(function (error) {\n      return alert(error.message);\n    });\n  };\n\n  return _jsxs(KeyboardAvoidingView, {\n    style: {\n      flex: 1,\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    children: [_jsx(View, {\n      style: styles.conversation,\n      children: conversation.map(function (convo, index) {\n        return _jsx(Text, {\n          style: styles.message,\n          children: convo.content\n        }, index);\n      })\n    }), _jsx(View, {\n      style: styles.inputContainer,\n      children: _jsx(TextInput, {\n        placeholder: \"Message\",\n        value: message,\n        onChangeText: function onChangeText(text) {\n          return setMessage(text);\n        },\n        style: styles.input\n      })\n    }), _jsx(View, {\n      style: styles.buttonContainer,\n      children: _jsx(TouchableOpacity, {\n        onPress: handleSend,\n        style: styles.button,\n        children: _jsx(Text, {\n          style: styles.buttonText,\n          children: \"Send\"\n        })\n      })\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  conversation: {\n    alignSelf: 'flex-start',\n    alignItems: 'left',\n    padding: '10%'\n  },\n  message: {\n    backgroundColor: 'white',\n    padding: 2,\n    margin: 5,\n    borderRadius: 400\n  },\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  inputContainer: {\n    width: '80%'\n  },\n  input: {\n    backgroundColor: 'white',\n    paddingHorizontal: 15,\n    paddingVertical: 10,\n    borderRadius: 10,\n    marginTop: 5\n  },\n  buttonContainer: {\n    width: '60%',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginTop: 40\n  },\n  button: {\n    backgroundColor: '#0782F9',\n    width: '100%',\n    padding: 15,\n    borderRadius: 10,\n    alignItems: 'center'\n  },\n  buttonOutline: {\n    backgroundColor: 'white',\n    marginTop: 5,\n    borderColor: '#0782F9',\n    borderWidth: 2\n  },\n  buttonText: {\n    color: 'white',\n    fontWeight: '700',\n    fontSize: 16\n  },\n  buttonOutlineText: {\n    color: '#0782F9',\n    fontWeight: '700',\n    fontSize: 16\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","auth","db","collection","onSnapshot","query","where","addDoc","getDoc","doc","getDocs","withTheme","Message","route","ConversationId","params","conversation","setConversation","message","setMessage","displayName","setDisplayName","snapshot","docs","map","convo","data","sort","a","b","timestamp","currentUser","uid","then","user","name","handleSend","Date","now","content","catch","error","alert","flex","alignItems","justifyContent","styles","index","inputContainer","text","input","buttonContainer","button","buttonText","StyleSheet","create","alignSelf","padding","backgroundColor","margin","borderRadius","container","width","paddingHorizontal","paddingVertical","marginTop","buttonOutline","borderColor","borderWidth","color","fontWeight","fontSize","buttonOutlineText"],"sources":["C:/Users/16476/Documents/GitHub/Haven/screens/Message.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { StyleSheet, Text, View, KeyboardAvoidingView, TextInput, TouchableOpacity, } from \"react-native\";\r\nimport { auth } from '../firebase'\r\nimport { db } from '../firebase'\r\nimport { collection, onSnapshot, query, where, addDoc, getDoc, doc, getDocs } from 'firebase/firestore' \r\nimport { withTheme } from 'react-native-elements';\r\n\r\nexport default function Message({ route }) {\r\n    const { ConversationId } = route.params\r\n    const [conversation, setConversation] = useState([])\r\n    const [message, setMessage] = useState('')\r\n    const [displayName, setDisplayName] = useState('')\r\n\r\n    useEffect(\r\n        () => \r\n            onSnapshot(query(collection(db, 'Messages'), where('ConversationId', '==', ConversationId)), (snapshot) =>\r\n            setConversation(snapshot.docs.map(convo => {\r\n                return convo.data()\r\n            }).sort((a,b) => a.timestamp - b.timestamp))\r\n            )\r\n    ,[])\r\n\r\n    useEffect(\r\n      () => {\r\n            getDocs(query(collection(db, 'users'), where('uid', '==', auth.currentUser?.uid)))\r\n            .then(user => setDisplayName(user.docs[0].data().name))\r\n          })\r\n\r\n    const handleSend = () => {\r\n  \r\n        addDoc(collection(db, 'Messages'),{ConversationId, timestamp: Date.now(), content: displayName + ' :' + message})\r\n        .then(() => {\r\n          setMessage('')\r\n        })\r\n        .catch(error => alert(error.message))\r\n    }\r\n    \r\n    return (\r\n        <KeyboardAvoidingView style={{ flex: 1, alignItems: 'center', justifyContent: 'center'}}>\r\n            <View style={styles.conversation}>\r\n              {conversation.map((convo,index) => <Text key={index} style={styles.message}>{convo.content}</Text>)}\r\n            </View>\r\n            <View style={styles.inputContainer}>\r\n                <TextInput \r\n                placeholder='Message'\r\n                value={message}\r\n                 onChangeText={text => setMessage(text)}\r\n                style={styles.input}\r\n                />\r\n            </View>\r\n\r\n            <View style={styles.buttonContainer}>\r\n                <TouchableOpacity\r\n                    onPress={handleSend}\r\n                    style={styles.button}\r\n                >\r\n                    <Text style={styles.buttonText}>Send</Text>\r\n                </TouchableOpacity>\r\n            </View>\r\n        </KeyboardAvoidingView>\r\n    )\r\n}\r\n\r\n\r\nconst styles = StyleSheet.create({\r\n    conversation: {\r\n      alignSelf: 'flex-start',\r\n      alignItems: 'left',\r\n      padding: '10%'\r\n    },\r\n    message: {\r\n      backgroundColor: 'white',\r\n      padding: 2,\r\n      margin: 5,\r\n      borderRadius: 400\r\n    },\r\n    container: {\r\n      flex: 1,\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n    },\r\n    inputContainer: {\r\n      width: '80%'\r\n    },\r\n    input: {\r\n      backgroundColor: 'white',\r\n      paddingHorizontal: 15,\r\n      paddingVertical: 10,\r\n      borderRadius: 10,\r\n      marginTop: 5,\r\n    },\r\n    buttonContainer: {\r\n      width: '60%',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      marginTop: 40,\r\n    },\r\n    button: {\r\n      backgroundColor: '#0782F9',\r\n      width: '100%',\r\n      padding: 15,\r\n      borderRadius: 10,\r\n      alignItems: 'center',\r\n    },\r\n    buttonOutline: {\r\n      backgroundColor: 'white',\r\n      marginTop: 5,\r\n      borderColor: '#0782F9',\r\n      borderWidth: 2,\r\n    },\r\n    buttonText: {\r\n      color: 'white',\r\n      fontWeight: '700',\r\n      fontSize: 16,\r\n    },\r\n    buttonOutlineText: {\r\n      color: '#0782F9',\r\n      fontWeight: '700',\r\n      fontSize: 16,\r\n    },\r\n  })"],"mappings":"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"},"metadata":{},"sourceType":"module"}