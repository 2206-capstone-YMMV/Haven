{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport { db } from \"../firebase\";\nimport { collection, onSnapshot, query, where, addDoc, serverTimestamp } from 'firebase/firestore';\nimport * as Location from \"expo-location\";\nimport { useNavigation } from '@react-navigation/core';\nimport { auth } from \"../firebase\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar NewPost = function NewPost() {\n  var navigation = useNavigation();\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      location = _useState2[0],\n      setLocation = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      errorMsg = _useState4[0],\n      setErrorMsg = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      description = _useState6[0],\n      setDescription = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      contents = _useState8[0],\n      setContents = _useState8[1];\n\n  var _useState9 = useState({}),\n      _useState10 = _slicedToArray(_useState9, 2),\n      profile = _useState10[0],\n      setProfile = _useState10[1];\n\n  var colRef = collection(db, 'Post');\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var _yield$Location$reque = yield Location.requestForegroundPermissionsAsync(),\n          status = _yield$Location$reque.status;\n\n      if (status !== \"granted\") {\n        setErrorMsg(\"Permission to access location was denied\");\n        return;\n      }\n\n      var location = yield Location.getCurrentPositionAsync({});\n      setLocation(location);\n    })();\n  }, []);\n  var text = \"Waiting...\";\n  var lat;\n  var lon;\n\n  if (errorMsg) {\n    text = errorMsg;\n  } else if (location) {\n    lat = location.coords.latitude;\n    lon = location.coords.longitude;\n  }\n\n  useEffect(function () {\n    var _auth$currentUser;\n\n    return onSnapshot(query(collection(db, 'users'), where('uid', '==', (_auth$currentUser = auth.currentUser) == null ? void 0 : _auth$currentUser.uid)), function (snapshot) {\n      return setProfile(snapshot.docs[0].data());\n    });\n  }, []);\n\n  var handleAddPost = function handleAddPost() {\n    var _auth$currentUser2;\n\n    addDoc(colRef, {\n      uid: (_auth$currentUser2 = auth.currentUser) == null ? void 0 : _auth$currentUser2.uid,\n      username: profile.name,\n      role: profile.role,\n      description: description,\n      email: profile.email,\n      createAt: serverTimestamp(),\n      contents: contents,\n      location: {\n        latitude: lat,\n        longitude: lon,\n        latitudeDelta: 0.0922,\n        longitudeDelta: 0.0421\n      }\n    }).then(function () {\n      navigation.navigate('Home');\n    });\n  };\n\n  return _jsxs(View, {\n    children: [_jsx(Text, {\n      children: \"NewPost\"\n    }), _jsx(TextInput, {\n      style: styles.input,\n      placeholder: \"description\",\n      onChangeText: function onChangeText(text) {\n        return setDescription(text);\n      }\n    }), _jsx(TextInput, {\n      style: styles.input,\n      placeholder: \"contents\",\n      onChangeText: function onChangeText(text) {\n        return setContents(text);\n      }\n    }), _jsx(TouchableOpacity, {\n      onPress: handleAddPost,\n      style: [styles.button],\n      children: _jsx(Text, {\n        style: styles.buttonOutLineText,\n        children: \"Submit\"\n      })\n    })]\n  });\n};\n\nexport default NewPost;\nvar styles = StyleSheet.create({\n  input: {\n    backgroundColor: 'white',\n    paddingHorizontal: 15,\n    paddingVertical: 10,\n    borderRadius: 10,\n    marginTop: 5\n  },\n  button: {\n    backgroundColor: '#0782F9',\n    width: '100%',\n    padding: 15,\n    borderRadius: 10,\n    alignItems: 'center'\n  }\n});","map":{"version":3,"names":["React","useEffect","useState","db","collection","onSnapshot","query","where","addDoc","serverTimestamp","Location","useNavigation","auth","NewPost","navigation","location","setLocation","errorMsg","setErrorMsg","description","setDescription","contents","setContents","profile","setProfile","colRef","requestForegroundPermissionsAsync","status","getCurrentPositionAsync","text","lat","lon","coords","latitude","longitude","currentUser","uid","snapshot","docs","data","handleAddPost","username","name","role","email","createAt","latitudeDelta","longitudeDelta","then","navigate","styles","input","button","buttonOutLineText","StyleSheet","create","backgroundColor","paddingHorizontal","paddingVertical","borderRadius","marginTop","width","padding","alignItems"],"sources":["C:/Users/16476/Documents/GitHub/Haven/screens/NewPost.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Text, View, StyleSheet, TouchableOpacity, TextInput } from \"react-native\";\r\nimport { db } from '../firebase'\r\nimport { collection, onSnapshot, query, where, addDoc, serverTimestamp } from 'firebase/firestore' \r\nimport * as Location from \"expo-location\";\r\n\r\nimport { useNavigation } from '@react-navigation/core'\r\nimport { auth } from '../firebase'\r\n\r\nconst NewPost = () => {\r\n    const navigation = useNavigation()\r\n    const [location, setLocation] = useState('');\r\n    const [errorMsg, setErrorMsg] = useState(null);\r\n    const [description, setDescription] = useState('')\r\n    const [contents, setContents] = useState('')\r\n    const [profile, setProfile] = useState({})\r\n    const colRef = collection(db, 'Post')\r\n    \r\n    useEffect(() => {\r\n        (async () => {\r\n          let { status } = await Location.requestForegroundPermissionsAsync();\r\n          if (status !== \"granted\") {\r\n            setErrorMsg(\"Permission to access location was denied\");\r\n            return;\r\n          }\r\n          let location = await Location.getCurrentPositionAsync({});\r\n          setLocation(location);\r\n        })();\r\n      }, []);\r\n      let text = \"Waiting...\";\r\n      let lat;\r\n      let lon;\r\n    \r\n      if (errorMsg) {\r\n        text = errorMsg;\r\n      } else if (location) {\r\n        lat = location.coords.latitude;\r\n        lon = location.coords.longitude;\r\n      }\r\n      useEffect(\r\n          () => \r\n              onSnapshot(query(collection(db, 'users'), where('uid', '==', auth.currentUser?.uid)), (snapshot) =>\r\n              setProfile(snapshot.docs[0].data())\r\n              )\r\n      ,[])\r\n      \r\n      const handleAddPost= () => {\r\n        addDoc(colRef,    {\r\n            uid: auth.currentUser?.uid,\r\n            username: profile.name,\r\n            role: profile.role,\r\n            description: description,\r\n            email: profile.email,\r\n            createAt: serverTimestamp(),\r\n            contents: contents,\r\n            location: {\r\n                latitude: lat,\r\n                longitude: lon,\r\n                latitudeDelta: 0.0922,\r\n                longitudeDelta: 0.0421,\r\n            }\r\n          })\r\n        .then(() => {\r\n            navigation.navigate('Home')\r\n \r\n        })\r\n    }\r\n  return (\r\n    <View>\r\n      <Text>NewPost</Text>\r\n      <TextInput style={styles.input} placeholder=\"description\" onChangeText={text => setDescription(text)} />\r\n      <TextInput style={styles.input} placeholder=\"contents\" onChangeText={text => setContents(text)} />\r\n      <TouchableOpacity\r\n            onPress={handleAddPost}\r\n            style={[styles.button]}\r\n        >\r\n            <Text style={styles.buttonOutLineText}>Submit</Text>\r\n        </TouchableOpacity>\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default NewPost\r\n\r\nconst styles = StyleSheet.create({   input: {\r\n  backgroundColor: 'white',\r\n  paddingHorizontal: 15,\r\n  paddingVertical: 10,\r\n  borderRadius: 10,\r\n  marginTop: 5,\r\n},\r\nbutton: {\r\n  backgroundColor: '#0782F9',\r\n  width: '100%',\r\n  padding: 15,\r\n  borderRadius: 10,\r\n  alignItems: 'center',\r\n},\r\n})"],"mappings":"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"},"metadata":{},"sourceType":"module"}